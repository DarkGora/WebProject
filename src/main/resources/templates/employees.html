<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Список сотрудников</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/styles/profile.css}">
</head>
<body>
<div class="container mt-4">
    <h1 class="mb-4">Список рабов</h1>

    <!-- Таблица сотрудников -->
    <table class="employee-table table table-hover">
        <thead>
        <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Телефон</th>
            <th>Email</th>
            <th>Что же сделать?</th>
        </tr>
        </thead>
        <tbody>
        <!-- Отображение всех сотрудников -->
        <tr th:each="employee : ${employees}"
            th:with="priority=${employee.name == 'Вася Пупкин' ? 2 : 1}"
            th:attr="data-priority=${priority}">
            <td th:text="${employee.id}"></td>
            <td>
                <a th:href="@{/employee/{id}(id=${employee.id})}" th:text="${employee.name}"
                   aria-label="Просмотр профиля сотрудника"></a>
            </td>
            <td th:text="${employee.phoneNumber}"></td>
            <td th:text="${employee.email}"></td>
            <td>
                <div class="action-buttons d-flex gap-2">
                    <!-- Кнопка просмотра -->
                    <a th:href="@{/employee/{id}(id=${employee.id})}" class="btn btn-view" role="button">
                        <i class="bi bi-eye"></i> Просмотр
                    </a>
                    <!-- Кнопка редактирования -->
                    <a th:href="@{/employee/edit/{id}(id=${employee.id})}" class="btn btn-edit" role="button">
                        <i class="bi bi-pencil"></i> Редактировать
                    </a>
                    <!-- Кнопка удаления с подтверждением -->
                    <form th:action="@{'/delete/' + ${employee.id}}" method="post" style="display: inline;">
                        <button type="submit" class="btn delete-btn" role="button"
                                onclick="return confirm('Вы уверены, что хотите удалить этого сотрудника?');">
                            <i class="bi bi-trash"></i> Delete!!!
                        </button>
                    </form>
                </div>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Кнопка добавления нового сотрудника -->
    <div class="mt-4">
        <a th:href="@{/employee/new}" class="btn btn-add" role="button">
            <i class="bi bi-plus-circle"></i> Добавить новенького.
        </a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Сортировка таблицы: "Вася Пупкин" становится вторым
    document.addEventListener("DOMContentLoaded", () => {
        const rows = Array.from(document.querySelectorAll("tbody tr"));
        rows.sort((a, b) => {
            const priorityA = parseInt(a.getAttribute("data-priority")) || 0;
            const priorityB = parseInt(b.getAttribute("data-priority")) || 0;
            return priorityA - priorityB; // Сортируем по возрастанию приоритета
        });
        const tbody = document.querySelector("tbody");
        rows.forEach(row => tbody.appendChild(row));
    });
</script>
</body>
</html>